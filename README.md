# Lumos AI Platform

> **Lumos** 是一个企业级 AI 知识与数据中台，旨在展示基于 Java 生态 (Spring AI) 构建 Modular Monolith 架构、RAG (检索增强生成) 及 Agent (智能代理) 的最佳实践。

## 📖 项目文档
详细架构设计请参阅 [Architecture Design](docs/ARCHITECTURE.md)。

## 🚀 快速开始 (Quick Start)

本项目支持两种启动模式，以适应不同的开发环境。

### 模式 A: Docker 完整模式 (推荐)
包含 Postgres (pgvector) 和 Redis，支持完整的向量检索功能。

1. **启动基础设施**:
   ```bash
   docker compose up -d
   ```
2. **运行应用**:
   ```bash
   mvn spring-boot:run -pl lumos-web
   ```
   应用将自动连接本地 5432 端口的 Postgres。

### 模式 B: Local 降级模式 (无 Docker)
使用 H2 内存数据库。**注意：此模式下向量检索功能不可用**，仅用于调试核心 CRUD 业务逻辑。

1. **运行应用**:
   ```bash
   mvn spring-boot:run -pl lumos-web -Dspring-boot.run.profiles=local
   ```

## 🛠️ 项目结构 (Modular Monolith)

- **`lumos-root`**: 父工程，依赖版本管理 (BOM)。
- **`lumos-api`**: (Shared Kernel) DTOs, Exceptions, 公共工具。
- **`lumos-core`**: (Domain) 核心业务逻辑，不依赖具体底层实现。
- **`lumos-infra`**: (Infrastructure) 数据库适配、Redis、AI Client 实现。
- **`lumos-web`**: (Presentation) 启动入口，REST API 控制器。

## 🗓️ 开发进度

- [x] **Phase 1: 基建与数据层**
    - [x] Maven 多模块骨架搭建
    - [x] Docker Compose (Postgres+pgvector, Redis)
    - [x] Flyway Schema 管理
    - [x] H2 本地降级方案
    - [x] 核心领域模型 (Idea) 实现
- [ ] **Phase 2: AI 能力接入 (进行中)**
    - [ ] Spring AI 集成
    - [ ] Embedding 生成与存储
    - [x] RAG 检索服务
- [x] **Phase 3: API 与 Agent**
    - [x] REST 接口暴露
    - [x] Text-to-SQL Agent (通过 IdeaService 间接实现)
- [x] **Phase 4: 工程化**
    - [x] 全局异常处理
    - [x] 单元测试 (JUnit 5 + Mockito)
    - [x] GitHub Actions CI

## 🧪 测试 (Testing)

项目包含核心业务逻辑的单元测试。

运行所有测试：
```bash
mvn test
```

### CI/CD
本项目集成了 GitHub Actions。每次推送到 `main` 分支或发起 Pull Request 时，会自动触发 Maven 构建和测试流程。配置文件位于 `.github/workflows/ci.yml`。

## 🤝 贡献与规范
- 提交代码前请确保通过 `pre-commit` 钩子检查。
- 请同步更新架构文档。

---
*Generated by Lumos Arch Team*
